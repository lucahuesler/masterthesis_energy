## Sensitivity analysis {#sec-sensitivity-analysis}

```{r}
#| label: load-libs
#| include: false

if (!require(pacman)) install.packages("pacman")
pacman::p_load(tidyverse, tidymodels, doParallel, skimr, plotly, sf, agua, gt,
               rules, baguette, ggridges, viridis, hrbrthemes, finetune, ggrepel,
               vip, shapviz, DALEXtra, h2o)

h2o.init()
```

```{r}
#| label: load-data
#| include: false

energy_modelling <- read_rds("data/energy_modelling.rds")

# best hepi model all predictors
hec_best_all_predictors <- h2o.loadModel("models/auto_ml_models/hec_all_predictors/StackedEnsemble_BestOfFamily_4_AutoML_2_20230507_122424")
```

```{r}

h2o.residual_analysis_plot(hec_best_all_predictors, test)

h2o.explain(hec_best_all_predictors, test, columns = c("heated_area_m2", "construction_year", "year_of_installation", "num_residents_mean", "building_class", "stand_alone", "elderly_ratio"))
```
